{% load static %}

{#
  Sidebar principal del sistema.

  Reglas:
  - No mostrar Plan 15 días (módulo deshabilitado por ahora).
  - Mantener agrupación por áreas.
  - "Próximamente" sólo visible para administración (evita ruido a usuarios operativos).
#}

<div class="ti-sidebar">

  <!-- Header / Marca -->
  <div class="ti-sidebar__brand">
    <div class="ti-brand">
      <div class="ti-brand__logo">
        <img src="{% static 'img/fondo_blanco.svg' %}" alt="La Termal ERP" class="dark:hidden" />
        <img src="{% static 'img/fondo_oscuro.svg' %}" alt="La Termal ERP" class="hidden dark:block" />
      </div>
      <div class="ti-brand__text">
        <div class="ti-brand__title">La Termal ERP</div>
        <div class="ti-brand__subtitle">Flota · Taller · Inventario</div>
      </div>
    </div>
  </div>

  <!-- Navegación -->
  <nav class="ti-nav">

    {% url 'core:dashboard' as url_dashboard %}

    {% url 'flota:colectivo_list' as url_colectivos %}
    {% url 'flota:salida_list' as url_horarios %}
    {% url 'flota:parte_list' as url_partes %}
    {% url 'flota:chofer_list' as url_choferes %}

    {% url 'inventario:producto_list' as url_inventario %}
    {% url 'inventario:movimiento_list' as url_movimientos %}

    {% url 'usuarios:usuario_list' as url_usuarios %}

    {% url 'flota:tv_horarios' as url_tv_horarios %}
    {% url 'flota:tv_taller' as url_tv_taller %}

    <!-- Operación -->
    <div class="ti-navtitle">Operación</div>

    <a href="{{ url_dashboard }}" class="ti-navitem {% if request.path|slice:':10' == '/dashboard' %}is-active{% endif %}">
      <span class="ti-navicon"><i class="fa-solid fa-house"></i></span>
      <span class="ti-navlabel">
        <span class="ti-navlabel__title">Inicio</span>
        <span class="ti-navlabel__subtitle">Panel general</span>
      </span>
    </a>


    <!-- Flota -->
    {% if show_flota|default:True %}
      <div class="ti-navtitle">Flota</div>

      <a href="{{ url_colectivos }}" class="ti-navitem {% if request.path|slice:':16' == '/flota/colectivos' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-bus"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Unidades</span>
          <span class="ti-navlabel__subtitle">Estado y vencimientos</span>
        </span>
      </a>

      <a href="{{ url_partes }}" class="ti-navitem {% if request.path|slice:':13' == '/flota/partes' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-regular fa-clipboard"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Partes diarios</span>
          <span class="ti-navlabel__subtitle">Registro y seguimiento</span>
        </span>
      </a>

      <a href="{{ url_horarios }}" class="ti-navitem {% if request.path|slice:':13' == '/flota/salidas' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-regular fa-clock"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Horarios</span>
          <span class="ti-navlabel__subtitle">Salidas y especiales</span>
        </span>
      </a>

      <a href="{{ url_choferes }}" class="ti-navitem {% if request.path|slice:':14' == '/flota/choferes' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-user"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Choferes</span>
          <span class="ti-navlabel__subtitle">Legajo básico</span>
        </span>
      </a>
    {% endif %}


    <!-- Inventario -->
    {% if show_inventario|default:True %}
      <div class="ti-navtitle">Inventario</div>

      <a href="{{ url_inventario }}" class="ti-navitem {% if request.path|slice:':20' == '/inventario/productos' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-boxes-stacked"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Inventario</span>
          <span class="ti-navlabel__subtitle">Productos, stock y movimientos</span>
        </span>
      </a>

      <a href="{{ url_movimientos }}" class="ti-navitem {% if request.path|slice:':22' == '/inventario/movimientos' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-right-left"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Movimientos</span>
          <span class="ti-navlabel__subtitle">Entradas / salidas / ajustes</span>
        </span>
      </a>
    {% endif %}


    <!-- Sistema -->
    {% if show_admin|default:request.user.is_superuser %}
      <div class="ti-navtitle">Sistema</div>

      <a href="{{ url_usuarios }}" class="ti-navitem {% if request.path|slice:':9' == '/usuarios' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-user-gear"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Administración</span>
          <span class="ti-navlabel__subtitle">Usuarios y roles</span>
        </span>
      </a>
    {% endif %}


    <!-- Pantallas (TV) -->
    {% if show_tv|default:request.user.is_superuser %}
      <div class="ti-navtitle">Pantallas</div>

      <a href="{{ url_tv_horarios }}" class="ti-navitem {% if request.path|slice:':17' == '/flota/tv/horarios' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-regular fa-rectangle-list"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">TV Horarios</span>
          <span class="ti-navlabel__subtitle">Próximas salidas</span>
        </span>
      </a>

      <a href="{{ url_tv_taller }}" class="ti-navitem {% if request.path|slice:':15' == '/flota/tv/taller' %}is-active{% endif %}">
        <span class="ti-navicon"><i class="fa-solid fa-screwdriver-wrench"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">TV Taller</span>
          <span class="ti-navlabel__subtitle">Partes y prioridad</span>
        </span>
      </a>
    {% endif %}


    <!-- Roadmap / Próximos módulos -->
    {% if show_admin|default:request.user.is_superuser %}
      <div class="ti-navtitle">Próximamente</div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-warehouse"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Compras</span>
          <span class="ti-navlabel__subtitle">Proveedores y facturas (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-gas-pump"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Combustible</span>
          <span class="ti-navlabel__subtitle">Cargas y consumo (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-screwdriver-wrench"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Taller</span>
          <span class="ti-navlabel__subtitle">Órdenes de trabajo (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-calendar-check"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Mantenimientos</span>
          <span class="ti-navlabel__subtitle">Programados (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-screwdriver"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Repuestos</span>
          <span class="ti-navlabel__subtitle">Consumos (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-bell"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Alertas</span>
          <span class="ti-navlabel__subtitle">Triage (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-chart-line"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Reportes</span>
          <span class="ti-navlabel__subtitle">Operativos (Próx.)</span>
        </span>
      </div>

      <div class="ti-navitem opacity-60 pointer-events-none">
        <span class="ti-navicon"><i class="fa-solid fa-circle-notch"></i></span>
        <span class="ti-navlabel">
          <span class="ti-navlabel__title">Gomería</span>
          <span class="ti-navlabel__subtitle">Cubiertas (Próx.)</span>
        </span>
      </div>
    {% endif %}

  </nav>


  <!-- Footer (usuario activo) -->
  <div class="ti-sidebar__footer">
    <div class="ti-user">
      <div class="ti-user__name">{{ request.user.username }}</div>
      <div class="ti-user__subtitle">Sesión activa</div>
    </div>

    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit" class="ti-btn-secondary">Salir</button>
    </form>
  </div>

</div>
